<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Theloders - Fast Downloader</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900 flex flex-col items-center p-8">

  <h1 class="text-4xl font-bold mb-6 text-orange-500">Theloders</h1>

  <div class="space-y-4 w-full max-w-xl">
    <input id="link" type="url" placeholder="Paste video URL" class="w-full p-3 border-2 border-orange-500 rounded" />

    <div class="flex items-center gap-4">
      <label><input type="radio" name="type" value="video" checked /> Video</label>
      <label><input type="radio" name="type" value="audio" /> Audio</label>
    </div>

    <button onclick="startDownload()" class="bg-orange-500 text-white px-6 py-3 rounded hover:bg-orange-600">
      Download
    </button>

    <div id="status" class="text-green-600 font-medium mt-4"></div>
    <div id="error" class="text-red-500 mt-2"></div>
  </div>

  <script>
    async function startDownload() {
      const link = document.getElementById('link').value;
      const type = document.querySelector('input[name="type"]:checked').value;
      const statusEl = document.getElementById('status');
      const errorEl = document.getElementById('error');
      statusEl.textContent = '';
      errorEl.textContent = '';

      if (!link.trim()) {
        errorEl.textContent = 'Please enter a valid URL.';
        return;
      }

      try {
        statusEl.textContent = 'Resolving media...';

        const res = await fetch(`https://your-render-backend.onrender.com/resolve?link=${encodeURIComponent(link)}&type=${type}`);
        const data = await res.json();

        if (!res.ok) throw new Error(data.error || 'Unknown error');

        const mediaRes = await fetch(data.url);
        const blob = await mediaRes.blob();
        const filename = `downloaded_${type}.${type === 'audio' ? 'mp3' : 'mp4'}`;
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        a.remove();

        statusEl.textContent = 'Download started.';
      } catch (err) {
        errorEl.textContent = 'Error: ' + err.message;
      }
    }
  </script>

</body>
</html>
